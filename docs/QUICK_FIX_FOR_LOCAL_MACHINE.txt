═══════════════════════════════════════════════════════════════
  QUICK FIX FOR YOUR LOCAL WINDOWS MACHINE
═══════════════════════════════════════════════════════════════

You need to edit this file on your Windows computer:
C:\Users\BOI VARSHNEY\PycharmProjects\V.A.T.S.A.L.23242\modules\system\system_control.py


WHAT TO CHANGE:
───────────────────────────────────────────────────────────────

1. Find this line (appears in multiple places):
   volume = cast(interface, POINTER(IAudioEndpointVolume))

2. Replace it with:
   volume = interface.QueryInterface(IAudioEndpointVolume)

3. Also REMOVE this import line wherever you see it:
   from ctypes import cast, POINTER

   And change it to just:
   (nothing - just delete it or leave the comtypes import only)


DETAILED INSTRUCTIONS:
───────────────────────────────────────────────────────────────

Step 1: Open the file in Notepad or your Python editor
File: C:\Users\BOI VARSHNEY\PycharmProjects\V.A.T.S.A.L.23242\modules\system\system_control.py

Step 2: Use Find & Replace (Ctrl+H in most editors)

Find what:
volume = cast(interface, POINTER(IAudioEndpointVolume))

Replace with:
volume = interface.QueryInterface(IAudioEndpointVolume)

Click "Replace All"

Step 3: Look for these imports at the top of functions:
from ctypes import cast, POINTER

Change them to remove "cast, POINTER" - just delete that part
(Keep: from comtypes import CLSCTX_ALL)

Step 4: Save the file (Ctrl+S)

Step 5: Restart your BOI GUI application


EXAMPLE OF THE CHANGE:
───────────────────────────────────────────────────────────────

OLD CODE (BROKEN):
    from pycaw.pycaw import AudioUtilities, IAudioEndpointVolume
    from comtypes import CLSCTX_ALL
    from ctypes import cast, POINTER
    
    devices = AudioUtilities.GetSpeakers()
    interface = devices.Activate(IAudioEndpointVolume._iid_, CLSCTX_ALL, None)
    volume = cast(interface, POINTER(IAudioEndpointVolume))  ← WRONG!
    volume.SetMute(True, None)

NEW CODE (FIXED):
    from pycaw.pycaw import AudioUtilities, IAudioEndpointVolume
    from comtypes import CLSCTX_ALL
    
    devices = AudioUtilities.GetSpeakers()
    interface = devices.Activate(IAudioEndpointVolume._iid_, CLSCTX_ALL, None)
    volume = interface.QueryInterface(IAudioEndpointVolume)  ← CORRECT!
    volume.SetMute(True, None)


FUNCTIONS TO UPDATE (all have the same fix):
───────────────────────────────────────────────────────────────
- set_volume()
- get_volume()
- mute_volume()
- unmute_volume()
- toggle_mute()
- mute_microphone()
- unmute_microphone()


AFTER THE FIX:
───────────────────────────────────────────────────────────────
1. Save the file
2. Close and restart your BOI application
3. Try typing "mute" again
4. It should work perfectly!


OR DOWNLOAD THE FIXED FILE:
───────────────────────────────────────────────────────────────
You can download the fixed system_control.py from this Replit:
1. Click on modules/system/system_control.py in Replit
2. Copy all the content
3. Paste it into your local file
4. Save and restart

═══════════════════════════════════════════════════════════════
